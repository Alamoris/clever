# Навигация по вертикальным ArUco-маркерам

Алгоритм обработки визуальных ArUco-маркеров, реализованный в образе Клевера позволяет максимально гибко настраивать положение как камеры, так и положение самих маркеров.

## Установка вертикального крепления камеры

Для более точного распознавания маркеров необходимо установить камеру вертикально, таким образом, чтобы объектив был направлен параллельно горизонту.

> **Note** Конфигурационный файл позволяет настраивать расположение камеры в пространстве относительно коптера любым образом. Для удобства далее будет рассматриваться вариант установки камеры под 90° к горизонту, по направлению носа коптера.

### Крепление камеры, 3D печать

Распечатайте [крепление камеры]() на 3D принтере.

По длине имеющегося у вас шлейфа установите крепление в удобное место, таким образом, чтобы в камере было минимальное количество лишних объектов(защита, ножки, пропеллеры, лучи), все эти части будут негативно сказываться на распознавании маркеров.

TODO: Если есть вставить рендеры и указать удобные места крепления

### Крепление камеры, лазерная резка

TODO: Если вообще такое будет, рассказать, что куда, зачем

## Настройка расположения камеры

Чтобы установить расположение камеры под необходимым вам углом, откройте файл *main_camera.launch*, расположенному по пути */home/pi/catkin_ws/src/clever/clever/launch/main_camera.launch*.

```bash
nano /home/pi/catkin_ws/src/clever/clever/launch/main_camera.launch
```

Необходимо или отредактировать одну из конфигурационных строк или добавить строку представленную ниже:

```
<node pkg="tf2_ros" type="static_transform_publisher" name="main_camera_frame" args="0.05 0 0.05 -1.5707963 0 -1.5707963 base_link main_camera_optical"/>
```

> **Note** Единовременно может использоваться только одна строка конфигурации камеры, если вы вставляете представленную выше строку, не забудьте закомментировать активную на данный момент. Для определения этого, вам поможет подсветка синтаксиса, используемая строка будет подсвечена другим цветом, нежели комментарии. Для комментирования в начало и конец строки добавьте символы *<!-- и -->* соответственно.

При использовании маркеров не привязанных к горизонтальным осям(пол, потолок), необходимо отключить параметр `known_tilt`, как в модуле `aruco_detect`, так и в модуле `aruco_map`. Для этого отредактируйте файл *aruco.launch*, расположенный по пути */home/pi/catkin_ws/src/clever/clever/launch/aruco.launch*.

TODO: Написать про карту, про дебаг, через web-rviz и дать скрины